{"ast":null,"code":"import _regeneratorRuntime from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/harish/Downloads/reactjs-chat-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/harish/Downloads/reactjs-chat-demo/src/Component/Main/Main.js\";\nimport React, { Component } from 'react';\nimport ReactLoading from 'react-loading';\nimport { withRouter } from 'react-router-dom';\nimport { myFirebase, myFirestore } from '../../Config/MyFirebase';\nimport images from '../Themes/Images';\nimport WelcomeBoard from '../WelcomeBoard/WelcomeBoard';\nimport './Main.css';\nimport ChatBoard from './../ChatBoard/ChatBoard';\nimport { AppString } from './../Const';\n\nvar Main =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Main, _Component);\n\n  function Main(props) {\n    var _this;\n\n    _classCallCheck(this, Main);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Main).call(this, props));\n\n    _this.checkLogin = function () {\n      if (!localStorage.getItem(AppString.ID)) {\n        _this.setState({\n          isLoading: false\n        }, function () {\n          _this.props.history.push('/');\n        });\n      } else {\n        _this.getListUser();\n      }\n    };\n\n    _this.getListUser =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return myFirestore.collection(AppString.NODE_USERS).get();\n\n            case 2:\n              result = _context.sent;\n\n              if (result.docs.length > 0) {\n                _this.listUser = _toConsumableArray(result.docs);\n\n                _this.setState({\n                  isLoading: false\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.onLogoutClick = function () {\n      _this.setState({\n        isOpenDialogConfirmLogout: true\n      });\n    };\n\n    _this.doLogout = function () {\n      _this.setState({\n        isLoading: true\n      });\n\n      myFirebase.auth().signOut().then(function () {\n        _this.setState({\n          isLoading: false\n        }, function () {\n          localStorage.clear();\n\n          _this.props.showToast(1, 'Logout success');\n\n          _this.props.history.push('/');\n        });\n      }).catch(function (err) {\n        this.setState({\n          isLoading: false\n        });\n        this.props.showToast(0, err.message);\n      });\n    };\n\n    _this.hideDialogConfirmLogout = function () {\n      _this.setState({\n        isOpenDialogConfirmLogout: false\n      });\n    };\n\n    _this.onProfileClick = function () {\n      _this.props.history.push('/profile');\n    };\n\n    _this.renderListUser = function () {\n      if (_this.listUser.length > 0) {\n        var viewListUser = [];\n\n        _this.listUser.forEach(function (item, index) {\n          if (item.data().id !== _this.currentUserId) {\n            viewListUser.push(React.createElement(\"button\", {\n              key: index,\n              className: _this.state.currentPeerUser && _this.state.currentPeerUser.id === item.data().id ? 'viewWrapItemFocused' : 'viewWrapItem',\n              onClick: function onClick() {\n                _this.setState({\n                  currentPeerUser: item.data()\n                });\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 87\n              },\n              __self: this\n            }, React.createElement(\"img\", {\n              className: \"viewAvatarItem\",\n              src: item.data().photoUrl,\n              alt: \"icon avatar\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 99\n              },\n              __self: this\n            }), React.createElement(\"div\", {\n              className: \"viewWrapContentItem\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 104\n              },\n              __self: this\n            }, React.createElement(\"span\", {\n              className: \"textItem\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 105\n              },\n              __self: this\n            }, \"Nickname: \".concat(item.data().nickname)), React.createElement(\"span\", {\n              className: \"textItem\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 108\n              },\n              __self: this\n            }, \"About me: \".concat(item.data().aboutMe ? item.data().aboutMe : 'Not available')))));\n          }\n        });\n\n        return viewListUser;\n      } else {\n        return null;\n      }\n    };\n\n    _this.renderDialogConfirmLogout = function () {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"viewWrapTextDialogConfirmLogout\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"titleDialogConfirmLogout\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"Are you sure to logout?\")), React.createElement(\"div\", {\n        className: \"viewWrapButtonDialogConfirmLogout\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btnYes\",\n        onClick: _this.doLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, \"YES\"), React.createElement(\"button\", {\n        className: \"btnNo\",\n        onClick: _this.hideDialogConfirmLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"CANCEL\")));\n    };\n\n    _this.state = {\n      isLoading: true,\n      isOpenDialogConfirmLogout: false,\n      currentPeerUser: null\n    };\n    _this.currentUserId = localStorage.getItem(AppString.ID);\n    _this.currentUserAvatar = localStorage.getItem(AppString.PHOTO_URL);\n    _this.currentUserNickname = localStorage.getItem(AppString.NICKNAME);\n    _this.listUser = [];\n    return _this;\n  }\n\n  _createClass(Main, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.checkLogin();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"root\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, \"MAIN\"), React.createElement(\"img\", {\n        className: \"icProfile\",\n        alt: \"An icon default avatar\",\n        src: images.ic_default_avatar,\n        onClick: this.onProfileClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(\"img\", {\n        className: \"icLogout\",\n        alt: \"An icon logout\",\n        src: images.ic_logout,\n        onClick: this.onLogoutClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"viewListUser\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \" \", this.renderListUser()), React.createElement(\"div\", {\n        className: \"viewBoard\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, this.state.currentPeerUser ? React.createElement(ChatBoard, {\n        currentPeerUser: this.state.currentPeerUser,\n        showToast: this.props.showToast,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }) : React.createElement(WelcomeBoard, {\n        currentUserNickname: this.currentUserNickname,\n        currentUserAvatar: this.currentUserAvatar,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }))), this.state.isOpenDialogConfirmLogout ? React.createElement(\"div\", {\n        className: \"viewCoverScreen\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, this.renderDialogConfirmLogout()) : null, this.state.isLoading ? React.createElement(\"div\", {\n        className: \"viewLoading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(ReactLoading, {\n        type: 'spin',\n        color: '#203152',\n        height: '3%',\n        width: '3%',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      })) : null);\n    }\n  }]);\n\n  return Main;\n}(Component);\n\nexport default withRouter(Main);","map":{"version":3,"sources":["/home/harish/Downloads/reactjs-chat-demo/src/Component/Main/Main.js"],"names":["React","Component","ReactLoading","withRouter","myFirebase","myFirestore","images","WelcomeBoard","ChatBoard","AppString","Main","props","checkLogin","localStorage","getItem","ID","setState","isLoading","history","push","getListUser","collection","NODE_USERS","get","result","docs","length","listUser","onLogoutClick","isOpenDialogConfirmLogout","doLogout","auth","signOut","then","clear","showToast","catch","err","message","hideDialogConfirmLogout","onProfileClick","renderListUser","viewListUser","forEach","item","index","data","id","currentUserId","state","currentPeerUser","photoUrl","nickname","aboutMe","renderDialogConfirmLogout","currentUserAvatar","PHOTO_URL","currentUserNickname","NICKNAME","ic_default_avatar","ic_logout"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport ReactLoading from 'react-loading'\nimport {withRouter} from 'react-router-dom'\nimport {myFirebase, myFirestore} from '../../Config/MyFirebase'\nimport images from '../Themes/Images'\nimport WelcomeBoard from '../WelcomeBoard/WelcomeBoard'\nimport './Main.css'\nimport ChatBoard from './../ChatBoard/ChatBoard'\nimport {AppString} from './../Const'\n\nclass Main extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            isLoading: true,\n            isOpenDialogConfirmLogout: false,\n            currentPeerUser: null\n        }\n        this.currentUserId = localStorage.getItem(AppString.ID)\n        this.currentUserAvatar = localStorage.getItem(AppString.PHOTO_URL)\n        this.currentUserNickname = localStorage.getItem(AppString.NICKNAME)\n        this.listUser = []\n    }\n\n    componentDidMount() {\n        this.checkLogin()\n    }\n\n    checkLogin = () => {\n        if (!localStorage.getItem(AppString.ID)) {\n            this.setState({isLoading: false}, () => {\n                this.props.history.push('/')\n            })\n        } else {\n            this.getListUser()\n        }\n    }\n\n    getListUser = async () => {\n        const result = await myFirestore.collection(AppString.NODE_USERS).get()\n        if (result.docs.length > 0) {\n            this.listUser = [...result.docs]\n            this.setState({isLoading: false})\n        }\n    }\n\n    onLogoutClick = () => {\n        this.setState({\n            isOpenDialogConfirmLogout: true\n        })\n    }\n\n    doLogout = () => {\n        this.setState({isLoading: true})\n        myFirebase\n            .auth()\n            .signOut()\n            .then(() => {\n                this.setState({isLoading: false}, () => {\n                    localStorage.clear()\n                    this.props.showToast(1, 'Logout success')\n                    this.props.history.push('/')\n                })\n            })\n            .catch(function (err) {\n                this.setState({isLoading: false})\n                this.props.showToast(0, err.message)\n            })\n    }\n\n    hideDialogConfirmLogout = () => {\n        this.setState({\n            isOpenDialogConfirmLogout: false\n        })\n    }\n\n    onProfileClick = () => {\n        this.props.history.push('/profile')\n    }\n\n    renderListUser = () => {\n        if (this.listUser.length > 0) {\n            let viewListUser = []\n            this.listUser.forEach((item, index) => {\n                if (item.data().id !== this.currentUserId) {\n                    viewListUser.push(\n                        <button\n                            key={index}\n                            className={\n                                this.state.currentPeerUser &&\n                                this.state.currentPeerUser.id === item.data().id\n                                    ? 'viewWrapItemFocused'\n                                    : 'viewWrapItem'\n                            }\n                            onClick={() => {\n                                this.setState({currentPeerUser: item.data()})\n                            }}\n                        >\n                            <img\n                                className=\"viewAvatarItem\"\n                                src={item.data().photoUrl}\n                                alt=\"icon avatar\"\n                            />\n                            <div className=\"viewWrapContentItem\">\n                <span className=\"textItem\">{`Nickname: ${\n                    item.data().nickname\n                    }`}</span>\n                                <span className=\"textItem\">{`About me: ${\n                                    item.data().aboutMe ? item.data().aboutMe : 'Not available'\n                                    }`}</span>\n                            </div>\n                        </button>\n                    )\n                }\n            })\n            return viewListUser\n        } else {\n            return null\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"root\">\n                {/* Header */}\n                <div className=\"header\">\n                    <span>MAIN</span>\n                    <img\n                        className=\"icProfile\"\n                        alt=\"An icon default avatar\"\n                        src={images.ic_default_avatar}\n                        onClick={this.onProfileClick}\n                    />\n                    <img\n                        className=\"icLogout\"\n                        alt=\"An icon logout\"\n                        src={images.ic_logout}\n                        onClick={this.onLogoutClick}\n                    />\n                </div>\n\n                {/* Body */}\n                <div className=\"body\">\n                    <div className=\"viewListUser\"> {this.renderListUser()}</div>\n                    <div className=\"viewBoard\">\n                        {this.state.currentPeerUser ? (\n                            <ChatBoard\n                                currentPeerUser={this.state.currentPeerUser}\n                                showToast={this.props.showToast}\n                            />\n                        ) : (\n                            <WelcomeBoard\n                                currentUserNickname={this.currentUserNickname}\n                                currentUserAvatar={this.currentUserAvatar}\n                            />\n                        )}\n                    </div>\n                </div>\n\n                {/* Dialog confirm */}\n                {this.state.isOpenDialogConfirmLogout ? (\n                    <div className=\"viewCoverScreen\">\n                        {this.renderDialogConfirmLogout()}\n                    </div>\n                ) : null}\n\n                {/* Loading */}\n                {this.state.isLoading ? (\n                    <div className=\"viewLoading\">\n                        <ReactLoading\n                            type={'spin'}\n                            color={'#203152'}\n                            height={'3%'}\n                            width={'3%'}\n                        />\n                    </div>\n                ) : null}\n            </div>\n        )\n    }\n\n    renderDialogConfirmLogout = () => {\n        return (\n            <div>\n                <div className=\"viewWrapTextDialogConfirmLogout\">\n                    <span className=\"titleDialogConfirmLogout\">Are you sure to logout?</span>\n                </div>\n                <div className=\"viewWrapButtonDialogConfirmLogout\">\n                    <button className=\"btnYes\" onClick={this.doLogout}>\n                        YES\n                    </button>\n                    <button className=\"btnNo\" onClick={this.hideDialogConfirmLogout}>\n                        CANCEL\n                    </button>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(Main)\n"]},"metadata":{},"sourceType":"module"}